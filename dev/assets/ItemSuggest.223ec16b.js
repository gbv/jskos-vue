import{h as e,A as s,e as t,B as n,C as l,D as u,V as a,v as o,x as r,n as c,o as i,c as v,p as g,E as d,G as m,b as p,H as h,k as f,I as y,F as k,q as w,w as S}from"./app.d85636fc.js";import{_ as R}from"./LoadingIndicator.10111b36.js";import"./shared.ae523b09.js";function b(t,n=!1){const l=e=>{for(const s of t()){const t=(s.elements||[]).reduce(((s,t)=>s||t&&t.contains(e.target)),!1);!n&&t||s.handler({event:e,isInside:t})}};e((()=>{document.addEventListener("click",l)})),s((()=>{document.removeEventListener("click",l)}))}function j(e,s,t){var n;return function(){var l=this,u=arguments,a=function(){n=null,t||e.apply(l,u)},o=t&&!n;clearTimeout(n),n=setTimeout(a,s),o&&e.apply(l,u)}}var I=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",dateToString:function(e){let s=new Date(e);if(s instanceof Date&&!isNaN(s)){if(e.length<10)return e;let t={year:"numeric",month:"short",day:"numeric"};return e.length>10&&(t=Object.assign({hour:"2-digit",minute:"2-digit",second:"2-digit"},t)),s.toLocaleString(void 0,t)}return"?"},addClickHandlers:b,debounce:j,cdkRegistryToSuggestFunction:function(e,{voc:s=!1,scheme:t}){return async n=>s?e.vocSuggest({search:n}):e.suggest({search:n,scheme:t})}});function L(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}const E=t({name:"ItemSuggest",components:{LoadingIndicator:R},props:{search:{type:Function,default:null}},emits:["select"],setup(e,{emit:s}){const t=n(!1),o=n(!1),r=n(null),c=n(""),i=n(-1),v=n([]),g=n(!1),d=n(null),m=n(null),p=n(null),h=j((async s=>{s=s.trim(),v.value=[],t.value=!0;const n=e.search(s);let l;r.value=n.cancel;try{l=(await n).slice(1).reduce(((e,s)=>e=s.map(((s,t)=>(e[t]||[]).concat(s)))),[])}catch(u){if("canceled"===u.message)return;console.error(u),l=[]}s===c.value.trim()&&(v.value=l,r.value=null,t.value=!1)}),200);l(c,(e=>{i.value=-1,null!=r.value&&(r.value("There was a newer search query."),r.value=null),""===e?(t.value=!1,o.value=!1):(v.value=["Waiting for you to stop typing..."],t.value=!0,o.value=!0,h(e))}));const f=()=>{o.value=!1},y=e=>{f(),i.value=-1,s("select",{uri:v.value[e][2]}),document.activeElement!==document.body&&document.activeElement.blur()},k=()=>{const e=p.value.childNodes[i.value+1];if(e){const s=e.parentElement.parentElement,t=e.getBoundingClientRect(),n=s.getBoundingClientRect();a.scrollTo(e,100,{container:s,easing:"ease-in",offset:t.bottom>n.bottom?-n.height+t.height:0,cancelable:!0,x:!1,y:!0,force:!1})}};return b((()=>[{elements:[d.value],handler:()=>{o.value=!1,i.value=-1}}])),{isLoading:t,isOpen:o,query:c,searchSelected:i,results:v,uniqueID:"abc",openResults:()=>{o.value=""!==c.value},closeResults:f,chooseResult:y,itemSuggest:d,searchInput:m,resultList:p,mouseover(e){g.value||(i.value=e)},mousemove(){g.value=!1},onArrowDown(){g.value=!0,i.value>=v.value.length-1?i.value=0:i.value+=1,k()},onArrowUp(){g.value=!0,i.value<=0?i.value=v.value.length-1:i.value-=1,k()},onEnter(){let e;t.value||0===v.value.length||(e=i.value<0||i.value>=v.value.length?0:i.value,y(e))},highlightQueryInResult:e=>{if(!c.value.length)return e;const s=c.value,t=new RegExp(s,"ig");let n=t.exec(e),l=0,u="";for(;n;){let a=n.index;u+=L(e.slice(l,a))+"<span class='jskos-vue-text-bold'>"+L(e.slice(a,a+s.length))+"</span>",l=a+s.length,n=t.exec(e)}return u+=L(e.slice(l)),u},focus(){m.value.focus()},setQuery(e,s=!1){c.value=e,s?m.value.focus():u((()=>{f()}))}}}}),T=S();o("data-v-c88d3a6c");const x={class:"jskos-vue-itemSuggest-results jskos-vue-text-small"},A={key:0,class:"jskos-vue-itemSuggest-loading"},D={ref:"resultList",class:"jskos-vue-itemSuggest-results-list"},_={key:0,class:"jskos-vue-itemSuggest-results-item"},q=p("div",null,"No results",-1);r();const C=T(((e,s,t,n,l,u)=>{const a=c("loading-indicator");return i(),v("div",{ref:"itemSuggest",class:"jskos-vue-itemSuggest",onMousemove:s[8]||(s[8]=(...s)=>e.mousemove&&e.mousemove(...s))},[g(" Input field "),d(p("input",{ref:"searchInput","onUpdate:modelValue":s[1]||(s[1]=s=>e.query=s),placeholder:"Type to search...",onClick:s[2]||(s[2]=(...s)=>e.openResults&&e.openResults(...s)),onKeydown:[s[3]||(s[3]=h(f(((...s)=>e.onArrowDown&&e.onArrowDown(...s)),["prevent"]),["down"])),s[4]||(s[4]=h(f(((...s)=>e.onArrowUp&&e.onArrowUp(...s)),["prevent"]),["up"]))],onKeyup:[s[5]||(s[5]=h(((...s)=>e.onEnter&&e.onEnter(...s)),["enter"])),s[6]||(s[6]=h((s=>{e.$refs.searchInput.blur(),e.closeResults()}),["esc"]))],onFocus:s[7]||(s[7]=(...s)=>e.openResults&&e.openResults(...s))},null,544),[[m,e.query]]),g(" Results "),d(p("div",x,[g(" Loading indicator if necessary "),e.isLoading?(i(),v("div",A,[p(a,{size:"md"})])):(i(),v(k,{key:1},[g(" If not loading, show results "),p("ul",D,[(i(!0),v(k,null,w(e.results,((s,t)=>(i(),v("li",{key:t,class:[{"jskos-vue-itemSuggest-selected":t===e.searchSelected},"jskos-vue-itemSuggest-results-item"],onClick:s=>e.chooseResult(t),onMouseover:s=>e.mouseover(t)},[p("span",{innerHTML:e.highlightQueryInResult(s[0])},null,8,["innerHTML"])],42,["onClick","onMouseover"])))),128)),0==e.results.length?(i(),v("li",_,[g(" TODO: Add other languages "),q])):g("v-if",!0)],512)],2112))],512),[[y,e.isOpen]])],544)}));E.render=C,E.__scopeId="data-v-c88d3a6c";export{E as _,I as u};
