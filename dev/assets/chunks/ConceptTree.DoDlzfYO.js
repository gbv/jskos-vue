import{_ as j,C as L,o as a,b as V,w as u,r as d,c as k,F as C,B as T,Z as O,e as v,K as B,d as S,af as U,h as A}from"./framework.CEMMUHjK.js";import{j as F}from"./index.dipmuM2f.js";import{I as q}from"./ItemList.B8rjcOLk.js";import{A as E}from"./Arrow.CifgFpCp.js";/* empty css               */import{a as f}from"./utils.D3G2_aoi.js";const H=S({name:"ConceptTree",components:{ItemList:q,Arrow:E},props:{modelValue:{type:Object,default:null},concepts:{type:Array,required:!0},hierarchy:{type:Boolean,default:!0},itemListOptions:{type:Object,default:()=>({})}},emits:["select","open","close","update:modelValue"],setup(t,{emit:n}){const i=U({}),h=o=>{let e=[],r=o.concept,p=o.depth+1;if(r&&i[r.uri])for(let l of r.narrower||[]){let c={concept:l,depth:p,isSelected:f(t.modelValue,l)};e.push(c),e=e.concat(h(c))}return e},y=A(()=>{let o=[];for(let e of t.concepts){let r={concept:e,depth:0,isSelected:f(t.modelValue,e)};o.push(r),t.hierarchy&&(o=o.concat(h(r)))}return o}),g=o=>{i[o.uri]=!0,n("open",o)},m=o=>{var p,l,c,$,b;let e=(p=t.modelValue)==null?void 0:p.uri,r=e;for(;e;){const s=(l=y.value.find(I=>f(I.concept,{uri:e})))==null?void 0:l.concept;if(e!==r&&f(s,o))return;e=(b=((c=s==null?void 0:s.ancestors)==null?void 0:c[0])||(($=s==null?void 0:s.broader)==null?void 0:$[0]))==null?void 0:b.uri}delete i[o.uri],n("close",o)};return{items:y,isOpen:i,open:g,close:m,toggle:o=>{i[o.uri]?m(o):g(o)},jskos:F}},methods:{isUriInView(...t){return this.$refs.itemList.isUriInView(...t)},scrollToUri(...t){this.$refs.itemList.scrollToUri(...t)}}}),K=["onClick"];function M(t,n,i,h,y,g){var o;const m=L("arrow"),w=L("item-list");return a(),V(w,B({ref:"itemList"},t.itemListOptions,{class:{"jskos-vue-conceptTree":!0,"jskos-vue-conceptTree-noHierarchy":!t.hierarchy},items:t.items,"item-property":"concept","highlight-by-uri":(o=t.modelValue)!=null&&o.uri?{[t.modelValue.uri]:!0}:{},onSelect:n[0]||(n[0]=e=>{t.$emit("select",e),t.$emit("update:modelValue",e.item)})}),{beforeItem:u(({item:e})=>[(a(!0),k(C,null,T(e.depth,r=>(a(),k("div",{key:r,class:"jskos-vue-conceptTree-depthSpacer"}))),128)),t.hierarchy?(a(),k("div",{key:0,class:"jskos-vue-conceptTree-arrow",onClick:O(r=>t.toggle(e.concept),["stop"])},[e.concept&&e.concept.narrower&&e.concept.narrower.length!==0?(a(),V(m,{key:0,direction:t.isOpen[e.concept.uri]?"down":"right",clickable:!0},null,8,["direction"])):v("",!0)],8,K)):v("",!0),d(t.$slots,"beforeItem",{item:e.concept})]),afterItem:u(({item:e})=>[d(t.$slots,"afterItem",{item:e.concept})]),beforeList:u(()=>[d(t.$slots,"beforeList")]),afterList:u(()=>[d(t.$slots,"afterList")]),_:3},16,["class","items","highlight-by-uri"])}const G=j(H,[["render",M]]);export{G as C};
