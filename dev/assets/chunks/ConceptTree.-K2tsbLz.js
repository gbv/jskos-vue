import{o as u,b,w as m,r as p,c as h,F as B,B as O,Z as S,e as L,K as U,ag as A,h as C}from"./framework.DrGHJ5PD.js";import{a as d}from"./utils.DzOti5Yg.js";import{I as F}from"./ItemList.D068vLHP.js";import{A as q}from"./Arrow.CdFlEDYj.js";/* empty css               */const E=["onClick"],Z={__name:"ConceptTree",props:{modelValue:{type:Object,default:null},concepts:{type:Array,required:!0},hierarchy:{type:Boolean,default:!0},itemListOptions:{type:Object,default:()=>({})}},emits:["select","open","close","update:modelValue"],setup(l,{expose:V,emit:v}){const c=l,f=v,n=A({}),y=e=>{let r=[],o=e.concept,t=e.depth+1;if(o&&n[o.uri])for(let s of o.narrower||[]){let a={concept:s,depth:t,isSelected:d(c.modelValue,s)};r.push(a),r=r.concat(y(a))}return r},k=C(()=>{let e=[];for(let r of c.concepts){let o={concept:r,depth:0,isSelected:d(c.modelValue,r)};e.push(o),c.hierarchy&&(e=e.concat(y(o)))}return e}),I=e=>{n[e.uri]=!0,f("open",e)},$=e=>{var t,s,a,g,w;let r=(t=c.modelValue)==null?void 0:t.uri,o=r;for(;r;){const i=(s=k.value.find(j=>d(j.concept,{uri:r})))==null?void 0:s.concept;if(r!==o&&d(i,e))return;r=(w=((a=i==null?void 0:i.ancestors)==null?void 0:a[0])||((g=i==null?void 0:i.broader)==null?void 0:g[0]))==null?void 0:w.uri}delete n[e.uri],f("close",e)},T=e=>{n[e.uri]?$(e):I(e)};return V({isUriInView(...e){return this.$refs.itemList.isUriInView(...e)},scrollToUri(...e){return this.$refs.itemList.scrollToUri(...e)}}),(e,r)=>{var o;return u(),b(F,U({ref:"itemList"},l.itemListOptions,{class:{"jskos-vue-conceptTree":!0,"jskos-vue-conceptTree-noHierarchy":!l.hierarchy},items:k.value,"item-property":"concept","highlight-by-uri":(o=l.modelValue)!=null&&o.uri?{[l.modelValue.uri]:!0}:{},onSelect:r[0]||(r[0]=t=>{e.$emit("select",t),e.$emit("update:modelValue",t.item)})}),{beforeItem:m(({item:t})=>[(u(!0),h(B,null,O(t.depth,s=>(u(),h("div",{key:s,class:"jskos-vue-conceptTree-depthSpacer"}))),128)),l.hierarchy?(u(),h("div",{key:0,class:"jskos-vue-conceptTree-arrow",onClick:S(s=>T(t.concept),["stop"])},[t.concept&&t.concept.narrower&&t.concept.narrower.length!==0?(u(),b(q,{key:0,direction:n[t.concept.uri]?"down":"right",clickable:!0},null,8,["direction"])):L("",!0)],8,E)):L("",!0),p(e.$slots,"beforeItem",{item:t.concept})]),afterItem:m(({item:t})=>[p(e.$slots,"afterItem",{item:t.concept})]),beforeList:m(()=>[p(e.$slots,"beforeList")]),afterList:m(()=>[p(e.$slots,"afterList")]),_:3},16,["class","items","highlight-by-uri"])}}};export{Z as _};
