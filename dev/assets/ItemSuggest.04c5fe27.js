import{A as e,h as t,B as s,e as n,C as l,D as u,V as a,v as o,x as r,n as c,o as i,c as v,p as g,E as d,G as m,b as p,H as h,k as f,I as y,F as k,q as S,w}from"./app.8f8c6958.js";import{_ as R}from"./LoadingIndicator.bf98f748.js";import"./shared.ae523b09.js";function b(e,n=!1){const l=t=>{for(const s of e()){const e=(s.elements||[]).reduce(((e,s)=>e||s&&s.contains(t.target)),!1);!n&&e||s.handler({event:t,isInside:e})}};t((()=>{document.addEventListener("click",l)})),s((()=>{document.removeEventListener("click",l)}))}function I(e,t,s){var n;return function(){var l=this,u=arguments,a=function(){n=null,s||e.apply(l,u)},o=s&&!n;clearTimeout(n),n=setTimeout(a,t),o&&e.apply(l,u)}}const j=e(null);function D(e){return{dragStart:function(e){j.value=e},dragEnd:function(){j.value=null},dragOver:function(e){e.preventDefault()},drop:function(t,...s){t.preventDefault(),j.value&&e(j.value,...s)},draggedItem:j}}var E=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",dateToString:function(e){let t=new Date(e);if(t instanceof Date&&!isNaN(t)){if(e.length<10)return e;let s={year:"numeric",month:"short",day:"numeric"};return e.length>10&&(s=Object.assign({hour:"2-digit",minute:"2-digit",second:"2-digit"},s)),t.toLocaleString(void 0,s)}return"?"},addClickHandlers:b,debounce:I,cdkRegistryToSuggestFunction:function(e,{voc:t=!1,scheme:s}){return async n=>t?e.vocSuggest({search:n}):e.suggest({search:n,scheme:s})},addDragAndDrop:D});function L(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}const T=n({name:"ItemSuggest",components:{LoadingIndicator:R},props:{search:{type:Function,default:null}},emits:["select"],setup(t,{emit:s}){const n=e(!1),o=e(!1),r=e(null),c=e(""),i=e(-1),v=e([]),g=e(!1),d=e(null),m=e(null),p=e(null),h=I((async e=>{e=e.trim(),v.value=[],n.value=!0;const s=t.search(e);let l;r.value=s.cancel;try{l=(await s).slice(1).reduce(((e,t)=>e=t.map(((t,s)=>(e[s]||[]).concat(t)))),[])}catch(u){if("canceled"===u.message)return;console.error(u),l=[]}e===c.value.trim()&&(v.value=l,r.value=null,n.value=!1)}),200);l(c,(e=>{i.value=-1,null!=r.value&&(r.value("There was a newer search query."),r.value=null),""===e?(n.value=!1,o.value=!1):(v.value=["Waiting for you to stop typing..."],n.value=!0,o.value=!0,h(e))}));const f=()=>{o.value=!1},y=e=>{f(),i.value=-1,s("select",{uri:v.value[e][2]}),document.activeElement!==document.body&&document.activeElement.blur()},k=()=>{const e=p.value.childNodes[i.value+1];if(e){const t=e.parentElement.parentElement,s=e.getBoundingClientRect(),n=t.getBoundingClientRect();a.scrollTo(e,100,{container:t,easing:"ease-in",offset:s.bottom>n.bottom?-n.height+s.height:0,cancelable:!0,x:!1,y:!0,force:!1})}};return b((()=>[{elements:[d.value],handler:()=>{o.value=!1,i.value=-1}}])),{isLoading:n,isOpen:o,query:c,searchSelected:i,results:v,uniqueID:"abc",openResults:()=>{o.value=""!==c.value},closeResults:f,chooseResult:y,itemSuggest:d,searchInput:m,resultList:p,mouseover(e){g.value||(i.value=e)},mousemove(){g.value=!1},onArrowDown(){g.value=!0,i.value>=v.value.length-1?i.value=0:i.value+=1,k()},onArrowUp(){g.value=!0,i.value<=0?i.value=v.value.length-1:i.value-=1,k()},onEnter(){let e;n.value||0===v.value.length||(e=i.value<0||i.value>=v.value.length?0:i.value,y(e))},highlightQueryInResult:e=>{if(!c.value.length)return e;const t=c.value,s=new RegExp(t,"ig");let n=s.exec(e),l=0,u="";for(;n;){let a=n.index;u+=L(e.slice(l,a))+"<span class='jskos-vue-text-bold'>"+L(e.slice(a,a+t.length))+"</span>",l=a+t.length,n=s.exec(e)}return u+=L(e.slice(l)),u},focus(){m.value.focus()},setQuery(e,t=!1){c.value=e,t?m.value.focus():u((()=>{f()}))}}}}),x=w();o("data-v-c88d3a6c");const A={class:"jskos-vue-itemSuggest-results jskos-vue-text-small"},_={key:0,class:"jskos-vue-itemSuggest-loading"},q={ref:"resultList",class:"jskos-vue-itemSuggest-results-list"},C={key:0,class:"jskos-vue-itemSuggest-results-item"},O=p("div",null,"No results",-1);r();const M=x(((e,t,s,n,l,u)=>{const a=c("loading-indicator");return i(),v("div",{ref:"itemSuggest",class:"jskos-vue-itemSuggest",onMousemove:t[8]||(t[8]=(...t)=>e.mousemove&&e.mousemove(...t))},[g(" Input field "),d(p("input",{ref:"searchInput","onUpdate:modelValue":t[1]||(t[1]=t=>e.query=t),placeholder:"Type to search...",onClick:t[2]||(t[2]=(...t)=>e.openResults&&e.openResults(...t)),onKeydown:[t[3]||(t[3]=h(f(((...t)=>e.onArrowDown&&e.onArrowDown(...t)),["prevent"]),["down"])),t[4]||(t[4]=h(f(((...t)=>e.onArrowUp&&e.onArrowUp(...t)),["prevent"]),["up"]))],onKeyup:[t[5]||(t[5]=h(((...t)=>e.onEnter&&e.onEnter(...t)),["enter"])),t[6]||(t[6]=h((t=>{e.$refs.searchInput.blur(),e.closeResults()}),["esc"]))],onFocus:t[7]||(t[7]=(...t)=>e.openResults&&e.openResults(...t))},null,544),[[m,e.query]]),g(" Results "),d(p("div",A,[g(" Loading indicator if necessary "),e.isLoading?(i(),v("div",_,[p(a,{size:"md"})])):(i(),v(k,{key:1},[g(" If not loading, show results "),p("ul",q,[(i(!0),v(k,null,S(e.results,((t,s)=>(i(),v("li",{key:s,class:[{"jskos-vue-itemSuggest-selected":s===e.searchSelected},"jskos-vue-itemSuggest-results-item"],onClick:t=>e.chooseResult(s),onMouseover:t=>e.mouseover(s)},[p("span",{innerHTML:e.highlightQueryInResult(t[0])},null,8,["innerHTML"])],42,["onClick","onMouseover"])))),128)),0==e.results.length?(i(),v("li",C,[g(" TODO: Add other languages "),O])):g("v-if",!0)],512)],2112))],512),[[y,e.isOpen]])],544)}));T.render=M,T.__scopeId="data-v-c88d3a6c";export{T as _,D as a,E as u};
