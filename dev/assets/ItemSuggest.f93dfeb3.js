import{A as e,h as t,B as s,l as n,e as a,C as l,D as u,V as o,v as r,x as c,n as i,o as v,c as d,p as g,E as m,G as p,b as h,H as f,k as y,I as k,F as w,q as S,w as L}from"./app.aab1c900.js";import{_ as R}from"./LoadingIndicator.d6ef6120.js";import"./shared.ae523b09.js";function b(e,n=!1){const a=t=>{for(const s of e()){const e=(s.elements||[]).reduce(((e,s)=>e||s&&s.contains(t.target)),!1);!n&&e||s.handler({event:t,isInside:e})}};t((()=>{document.addEventListener("click",a)})),s((()=>{document.removeEventListener("click",a)}))}function E(e,t,s){var n;return function(){var a=this,l=arguments,u=function(){n=null,s||e.apply(a,l)},o=s&&!n;clearTimeout(n),n=setTimeout(u,t),o&&e.apply(a,l)}}const I=e(null),j={draggedItem:I,dragstart(e){I.value=e},dragend(){I.value=null},addDropzone(t,s){const a=e(0),l=n((()=>!!a.value)),u=e=>{e.preventDefault()},o=()=>{a.value+=1},r=()=>{a.value-=1},c=(e,...t)=>{e.preventDefault(),I.value&&s(I.value,...t),a.value=0};return t&&(t.addEventListener("dragover",u),t.addEventListener("dragenter",o),t.addEventListener("dragleave",r),t.addEventListener("drop",c)),{dragover:u,dragenter:o,dragleave:r,drop:c,isDraggingOver:l}}};var D=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",dateToString:function(e){let t=new Date(e);if(t instanceof Date&&!isNaN(t)){if(e.length<10)return e;let s={year:"numeric",month:"short",day:"numeric"};return e.length>10&&(s=Object.assign({hour:"2-digit",minute:"2-digit",second:"2-digit"},s)),t.toLocaleString(void 0,s)}return"?"},addClickHandlers:b,debounce:E,cdkRegistryToSuggestFunction:function(e,{voc:t=!1,scheme:s}){return async n=>t?e.vocSuggest({search:n}):e.suggest({search:n,scheme:s})},dragAndDrop:j});function T(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}const x=a({name:"ItemSuggest",components:{LoadingIndicator:R},props:{search:{type:Function,default:null}},emits:["select"],setup(t,{emit:s}){const n=e(!1),a=e(!1),r=e(null),c=e(""),i=e(-1),v=e([]),d=e(!1),g=e(null),m=e(null),p=e(null),h=E((async e=>{e=e.trim(),v.value=[],n.value=!0;const s=t.search(e);let a;r.value=s.cancel;try{a=(await s).slice(1).reduce(((e,t)=>e=t.map(((t,s)=>(e[s]||[]).concat(t)))),[])}catch(l){if("canceled"===l.message)return;console.error(l),a=[]}e===c.value.trim()&&(v.value=a,r.value=null,n.value=!1)}),200);l(c,(e=>{i.value=-1,null!=r.value&&(r.value("There was a newer search query."),r.value=null),""===e?(n.value=!1,a.value=!1):(v.value=["Waiting for you to stop typing..."],n.value=!0,a.value=!0,h(e))}));const f=()=>{a.value=!1},y=e=>{f(),i.value=-1,s("select",{uri:v.value[e][2]}),document.activeElement!==document.body&&document.activeElement.blur()},k=()=>{const e=p.value.childNodes[i.value+1];if(e){const t=e.parentElement.parentElement,s=e.getBoundingClientRect(),n=t.getBoundingClientRect();o.scrollTo(e,100,{container:t,easing:"ease-in",offset:s.bottom>n.bottom?-n.height+s.height:0,cancelable:!0,x:!1,y:!0,force:!1})}};return b((()=>[{elements:[g.value],handler:()=>{a.value=!1,i.value=-1}}])),{isLoading:n,isOpen:a,query:c,searchSelected:i,results:v,uniqueID:"abc",openResults:()=>{a.value=""!==c.value},closeResults:f,chooseResult:y,itemSuggest:g,searchInput:m,resultList:p,mouseover(e){d.value||(i.value=e)},mousemove(){d.value=!1},onArrowDown(){d.value=!0,i.value>=v.value.length-1?i.value=0:i.value+=1,k()},onArrowUp(){d.value=!0,i.value<=0?i.value=v.value.length-1:i.value-=1,k()},onEnter(){let e;n.value||0===v.value.length||(e=i.value<0||i.value>=v.value.length?0:i.value,y(e))},highlightQueryInResult:e=>{if(!c.value.length)return e;const t=c.value,s=new RegExp(t,"ig");let n=s.exec(e),a=0,l="";for(;n;){let u=n.index;l+=T(e.slice(a,u))+"<span class='jskos-vue-text-bold'>"+T(e.slice(u,u+t.length))+"</span>",a=u+t.length,n=s.exec(e)}return l+=T(e.slice(a)),l},focus(){m.value.focus()},setQuery(e,t=!1){c.value=e,t?m.value.focus():u((()=>{f()}))}}}}),A=L();r("data-v-c88d3a6c");const _={class:"jskos-vue-itemSuggest-results jskos-vue-text-small"},q={key:0,class:"jskos-vue-itemSuggest-loading"},C={ref:"resultList",class:"jskos-vue-itemSuggest-results-list"},O={key:0,class:"jskos-vue-itemSuggest-results-item"},M=h("div",null,"No results",-1);c();const F=A(((e,t,s,n,a,l)=>{const u=i("loading-indicator");return v(),d("div",{ref:"itemSuggest",class:"jskos-vue-itemSuggest",onMousemove:t[8]||(t[8]=(...t)=>e.mousemove&&e.mousemove(...t))},[g(" Input field "),m(h("input",{ref:"searchInput","onUpdate:modelValue":t[1]||(t[1]=t=>e.query=t),placeholder:"Type to search...",onClick:t[2]||(t[2]=(...t)=>e.openResults&&e.openResults(...t)),onKeydown:[t[3]||(t[3]=f(y(((...t)=>e.onArrowDown&&e.onArrowDown(...t)),["prevent"]),["down"])),t[4]||(t[4]=f(y(((...t)=>e.onArrowUp&&e.onArrowUp(...t)),["prevent"]),["up"]))],onKeyup:[t[5]||(t[5]=f(((...t)=>e.onEnter&&e.onEnter(...t)),["enter"])),t[6]||(t[6]=f((t=>{e.$refs.searchInput.blur(),e.closeResults()}),["esc"]))],onFocus:t[7]||(t[7]=(...t)=>e.openResults&&e.openResults(...t))},null,544),[[p,e.query]]),g(" Results "),m(h("div",_,[g(" Loading indicator if necessary "),e.isLoading?(v(),d("div",q,[h(u,{size:"md"})])):(v(),d(w,{key:1},[g(" If not loading, show results "),h("ul",C,[(v(!0),d(w,null,S(e.results,((t,s)=>(v(),d("li",{key:s,class:[{"jskos-vue-itemSuggest-selected":s===e.searchSelected},"jskos-vue-itemSuggest-results-item"],onClick:t=>e.chooseResult(s),onMouseover:t=>e.mouseover(s)},[h("span",{innerHTML:e.highlightQueryInResult(t[0])},null,8,["innerHTML"])],42,["onClick","onMouseover"])))),128)),0==e.results.length?(v(),d("li",O,[g(" TODO: Add other languages "),M])):g("v-if",!0)],512)],2112))],512),[[k,e.isOpen]])],544)}));x.render=F,x.__scopeId="data-v-c88d3a6c";export{x as _,j as d,D as u};
