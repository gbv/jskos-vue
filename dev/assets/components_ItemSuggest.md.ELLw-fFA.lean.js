import{_ as j,d as N,o as u,c as y,a3 as R,a4 as O,j as q,Z as C,$ as I,a5 as x,I as B,F as z,E as K,n as W,e as H,s as l,v as U,R as Q,D as J,y as G,a1 as v}from"./chunks/framework.DOrQYd6A.js";import{L as Y}from"./chunks/LoadingIndicator.BIFdSjTT.js";import{V as Z}from"./chunks/vue-scrollto.FOkUA__D.js";import{a as X,d as ss,c as P}from"./chunks/utils.Cs71LNG2.js";import"./chunks/shared.l0sNRNKZ.js";import{c as V}from"./chunks/index.C1QD6wya.js";import"./chunks/jskos-tools.CpjLtWvA.js";function D(s){return s.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}const is=N({name:"ItemSuggest",components:{LoadingIndicator:Y},props:{search:{type:Function,default:null}},emits:["select"],setup(s,{emit:n}){const E=l(!1),d=l(!1),g=l(null),r=l(""),t=l(-1),i=l([]),k="abc",h=l(!1),S=l(null),f=l(null),_=l(null),L=ss(async a=>{a=a.trim(),i.value=[],E.value=!0;const p=s.search(a);g.value=p.cancel;let o;try{o=(await p).slice(1).reduce((e,F)=>(e=F.map((m,c)=>(e[c]||[]).concat(m)),e),[])}catch(e){if(e.message==="canceled")return;console.error(e),o=[]}a===r.value.trim()&&(i.value=o,g.value=null,E.value=!1)},200);U(r,a=>{t.value=-1,g.value!=null&&(g.value("There was a newer search query."),g.value=null),a===""?(E.value=!1,d.value=!1):(i.value=["Waiting for you to stop typing..."],E.value=!0,d.value=!0,L(a))});const M=()=>{d.value=r.value!==""},A=()=>{d.value=!1},w=a=>{A(),t.value=-1,n("select",{uri:i.value[a][2]}),document.activeElement!==document.body&&document.activeElement.blur()},$=a=>{if(!r.value.length)return a;const p=r.value,o=new RegExp(p,"ig");let e=o.exec(a),F=0,m="";for(;e;){let c=e.index;m+=D(a.slice(F,c))+"<span class='jskos-vue-text-bold'>"+D(a.slice(c,c+p.length))+"</span>",F=c+p.length,e=o.exec(a)}return m+=D(a.slice(F)),m},T=()=>{const a=_.value.childNodes[t.value+1];if(a){const p=a.parentElement.parentElement,o=a.getBoundingClientRect(),e=p.getBoundingClientRect();Z.scrollTo(a,100,{container:p,easing:"ease-in",offset:o.bottom>e.bottom?-e.height+o.height:0,cancelable:!0,x:!1,y:!0,force:!1})}};return X(()=>[{elements:[S.value],handler:()=>{d.value=!1,t.value=-1}}]),{isLoading:E,isOpen:d,query:r,searchSelected:t,results:i,uniqueID:k,openResults:M,closeResults:A,chooseResult:w,itemSuggest:S,searchInput:f,resultList:_,mouseover(a){h.value||(t.value=a)},mousemove(){h.value=!1},onArrowDown(){h.value=!0,t.value>=i.value.length-1?t.value=0:t.value+=1,T()},onArrowUp(){h.value=!0,t.value<=0?t.value=i.value.length-1:t.value-=1,T()},onEnter(){let a;E.value||i.value.length===0||(t.value<0||t.value>=i.value.length?a=0:a=t.value,w(a))},highlightQueryInResult:$,focus(){f.value.focus()},setQuery(a,p=!1){r.value=a,p?f.value.focus():Q(()=>{A()})}}}}),as={class:"jskos-vue-itemSuggest-results jskos-vue-text-small"},ts={key:0,class:"jskos-vue-itemSuggest-loading"},ns={key:1,ref:"resultList",class:"jskos-vue-itemSuggest-results-list"},es=["onClick","onMouseover"],hs=["innerHTML"],ls={key:0,class:"jskos-vue-itemSuggest-results-item"},ks=q("div",null,"No results",-1),ps=[ks];function Es(s,n,E,d,g,r){const t=J("loading-indicator");return u(),y("div",{ref:"itemSuggest",class:"jskos-vue-itemSuggest",onMousemove:n[7]||(n[7]=(...i)=>s.mousemove&&s.mousemove(...i))},[R(q("input",{ref:"searchInput","onUpdate:modelValue":n[0]||(n[0]=i=>s.query=i),placeholder:"Type to search...",onClick:n[1]||(n[1]=(...i)=>s.openResults&&s.openResults(...i)),onKeydown:[n[2]||(n[2]=C(I((...i)=>s.onArrowDown&&s.onArrowDown(...i),["prevent"]),["down"])),n[3]||(n[3]=C(I((...i)=>s.onArrowUp&&s.onArrowUp(...i),["prevent"]),["up"]))],onKeyup:[n[4]||(n[4]=C((...i)=>s.onEnter&&s.onEnter(...i),["enter"])),n[5]||(n[5]=C(i=>{s.$refs&&s.$refs.searchInput&&s.$refs.searchInput.blur(),s.closeResults()},["esc"]))],onFocus:n[6]||(n[6]=(...i)=>s.openResults&&s.openResults(...i))},null,544),[[O,s.query]]),R(q("div",as,[s.isLoading?(u(),y("div",ts,[B(t,{size:"md"})])):(u(),y("ul",ns,[(u(!0),y(z,null,K(s.results,(i,k)=>(u(),y("li",{key:k,class:W([{"jskos-vue-itemSuggest-selected":k===s.searchSelected},"jskos-vue-itemSuggest-results-item"]),onClick:h=>s.chooseResult(k),onMouseover:h=>s.mouseover(k)},[q("span",{innerHTML:s.highlightQueryInResult(i[0])},null,8,hs)],42,es))),128)),s.results.length==0?(u(),y("li",ls,ps)):H("",!0)],512))],512),[[x,s.isOpen]])],544)}const b=j(is,[["render",Es]]),rs=v("",11),ds=v("",3),os=v("",3),gs=v("",1),vs=JSON.parse('{"title":"ItemSuggest","description":"","frontmatter":{},"headers":[],"relativePath":"components/ItemSuggest.md","filePath":"components/ItemSuggest.md"}'),us={name:"components/ItemSuggest.md"},fs=Object.assign(us,{setup(s){const n=l(null),E=l(null);G(()=>{n.value=V.initializeRegistry({provider:"ConceptApi",api:"https://coli-conc.gbv.de/api/"}),E.value=V.initializeRegistry({provider:"ConceptApi",api:"https://bartoc.org/api/"})});const d={uri:"http://dewey.info/scheme/edition/e23/",license:[{uri:"http://creativecommons.org/licenses/by-nc-nd/3.0/"}]},g=[{id:1,name:"Bulbasaur"},{id:2,name:"Ivysaur"},{id:3,name:"Venusaur"},{id:4,name:"Charmander"},{id:5,name:"Charmeleon"},{id:6,name:"Charizard"},{id:7,name:"Squirtle"},{id:8,name:"Wartortle"},{id:9,name:"Blastoise"},{id:10,name:"Caterpie"},{id:11,name:"Metapod"},{id:12,name:"Butterfree"},{id:13,name:"Weedle"},{id:14,name:"Kakuna"},{id:15,name:"Beedrill"},{id:16,name:"Pidgey"},{id:17,name:"Pidgeotto"},{id:18,name:"Pidgeot"},{id:19,name:"Rattata"},{id:20,name:"Raticate"}],r=async t=>{t=t.toLowerCase();const i=g.filter(h=>h.name.toLowerCase().includes(t)),k=[t];return k[1]=i.map(h=>h.name),k[2]=i.map(()=>""),k[3]=i.map(h=>`pokemon:${h.id}`),k};return(t,i)=>(u(),y("div",null,[rs,B(b,{search:r}),ds,B(b,{search:P(n.value,{scheme:d})},null,8,["search"]),os,B(b,{search:P(E.value,{voc:!0})},null,8,["search"]),gs]))}});export{vs as __pageData,fs as default};
